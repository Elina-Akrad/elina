(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9478],{8044:function(e,t,n){"use strict";n.d(t,{y:function(){return s}});var r=n(45227),a=n(1324),o=n(76778),s=(0,a.q)({url:function(e){var t=e.orderItemId;return"rate-review/order/".concat(t,"/rate-submit/")},type:r.XN.POST,inputTransformer:function(e){var t=e.rate,n=e.problemReasonId;return{rate:(0,o._G)(t),problem:n}}})},90865:function(e,t,n){"use strict";n.d(t,{t:function(){return g}});var r=n(70865),a=n(52322),o=n(96670),s=n(26297),i=n(66383),l=n(2784),c=n(45954),d=n(47842),u=n(74424),m=n(23325),p=n(813),f=n(18936),x=n(52871),v=n(32534),h=n.n(v);function b(e){var t=e.className,n=e.maxFiles,s=e.title,i=e.subTitle,l=e.accept,c=e.children,v=e.hasPreviewItem,b=e.updateFiles,N=e.hasError,j=e.hideButton,g=e.dropZoneBody,_=e.multiple,y=(0,u.uI)({onDrop:function(e){(0,x.xb)(e)||null==b||b(e)},multiple:_,maxFiles:void 0===n?1:n,accept:void 0===l?"image/jpeg, image/png, video/*":l,disabled:!!N}),T=y.getRootProps,I=y.getInputProps,C=y.isDragActive,S=y.isDragReject,M=(0,f.d)("p-5 bg-neutral-000 rounded border-complete text-center",(0,d.Z)({},h()["UploadBox__dropZone--active-drag"],C),(0,d.Z)({},h()["UploadBox__dropZone--error"],N||S),{"border-complete-200":!C&&!N},h().UploadBox__dropZone,t);return(0,a.jsxs)("div",(0,o.Z)((0,r.Z)({},T({className:M})),{children:[(0,a.jsx)("input",(0,r.Z)({},I())),g||(0,a.jsxs)("div",{children:[(0,a.jsx)("h6",{className:"text-body-2 text-center text-neutral-700",children:void 0===s?"عکس یا ویدیو خود را جهت بارگذاری داخل کادر بیاندازید.":s}),(0,a.jsx)("p",{className:"text-caption text-center text-neutral-700",children:void 0===i?"حداکثر ۵ تصویر jpeg یا PNG حداکثر یک مگابایت، یک ویدئو MP4 حداکثر ۵۰ مگابایت":i})]}),(0,a.jsxs)("div",{className:"flex justify-evenly items-center mt-4",children:[!(void 0!==j&&j)&&(0,a.jsxs)(p.zx,{type:"button",size:"large",shape:"outlined",color:"primary",children:[(0,a.jsx)(m.J,{icon:"fileTransferUpload",size:22,color:"primary",className:"ml-2"}),"بارگذاری تصویر"]}),void 0!==v&&v&&c]})]}))}var N=n(6277);function j(e){var t=e.className,n=e.errorClassName,d=e.error,u=e.subTitle,m=e.accept,p=e.dropZoneClassName,f=(0,s.Z)(e,["className","errorClassName","error","subTitle","accept","dropZoneClassName"]),x=(0,i.Z)((0,l.useState)([]),2),v=x[0],h=x[1],j=(0,l.useCallback)(function(e){var t=e.map(function(e){return Object.assign(e,{preview:URL.createObjectURL(e)})});h(t),f.upload&&f.upload({files:t})},[h]),g=v.map(function(e){return e.name});return(0,l.useEffect)(function(){return function(){v.forEach(function(e){return URL.revokeObjectURL(e.preview)})}},[v]),(0,a.jsxs)("div",{className:(0,N.Z)(t,"cursor-pointer"),children:[(0,a.jsx)(b,(0,o.Z)((0,r.Z)({updateFiles:j,hasPreviewItem:v.length>0,hasError:!!d,subTitle:u,accept:m,className:p},f),{children:(0,a.jsx)("p",{className:"text-left text-neutral-500 text-body-2",children:g})})),d&&(0,a.jsx)(c.kW,{color:"error",icon:"infoFill",className:n,title:d})]})}function g(e){return(0,a.jsx)(j,(0,r.Z)({},e))}},22025:function(e,t,n){"use strict";n.d(t,{O:function(){return eC}});var r,a=n(47842),o=n(66383),s=n(50930),i=n(52322),l=n(2784),c=n(70865),d=n(98780),u=n(97411),m=n(45227),p=n(1324),f=(0,p.q)({type:m.XN.POST,url:"comments/media/bulk-delete/",inputTransformer:function(e){return{media_ids:e.mediaIds}}}),x=n(64665),v=n(11559),h=n(42306),b=n(41435),N=n(72677),j=n(31909),g=n(61695),_=n(82332),y=n(45859),T=n.n(y);function I(e){var t=e.mediaUrl,n=e.mediaThumbnailUrl,r=e.mediaFileType,a=e.onDelete,o=(0,_.t)(r,g.L.VIDEO),s=(0,h.d)(x.X.ADD_COMMENT_FORM_SINGLE_STEP)||(0,h.d)(x.X.ADD_COMMENT_FORM_MULTIPLE_STEP);return(0,i.jsxs)("div",{className:(0,N.d)({"mr-2 overflow-hidden min-w-24":!s},"rounded relative",{"h-18 w-18":s}),children:[(0,i.jsx)(j.E,{src:n||t,alt:"digikala",width:s?72:96,height:s?72:96,className:"bg-neutral-900 rounded"}),o&&(0,i.jsx)(d.J,{icon:"playSimple",size:s?16:24,color:"white",className:(0,N.d)("absolute rounded-circle",T().AddCommentMediaItem__VideoPlayButton)}),(0,i.jsx)("div",{className:(0,N.d)("p-1 absolute rounded-medium bottom-1 left-1",{"p-2":s},T().AddCommentMediaItem__CTADeleteIcon),children:(0,i.jsx)(d.J,{icon:"delete",size:s?16:24,color:"white",onClick:a})})]})}var C=n(96670),S=n(26297),M=n(23945),Z=n(90865),w=n(64248),E=n(95976),O=(0,p.q)({type:m.XN.POST,url:"media/upload/comments/",options:{timeout:18e4},transformer:function(e){var t;return(0,w.Y)({temporaryMedia:(0,E.w)({data:null==e?void 0:null===(t=e.data)||void 0===t?void 0:t.temporary_media})})},inputTransformer:function(e){var t=e.file,n=new FormData;return n.append("file",t),n}}),U=n(52216);function k(e){var t=e.file,n=e.onSuccess,r=e.onFailed,a=e.className,s=(0,o.Z)((0,l.useState)(0),2),c=s[0],u=s[1],m=(0,v.E)({apiMethod:O,onUploadProgressCallback:function(e){var t=Math.floor(100*e.loaded/e.total);t<=100&&u(t)},onSuccess:function(e){n(null==e?void 0:e.temporaryMedia)},onError:r,requestDataOnLoad:{file:t},fireOnLoad:!!t}).cancelRequest;return(0,i.jsxs)("div",{className:(0,N.d)("relative ml-2 overflow-hidden rounded-medium bg-neutral-900 h-[96px] w-[96px]",a),children:[(0,i.jsxs)("div",{className:(0,N.d)("absolute flex items-center text-neutral-000 left-[15px] top-[15px]"),children:[(0,i.jsx)(d.J,{icon:"fileTransferUpload",color:"white",size:24}),(0,i.jsxs)("p",{className:"mr-2",children:[(0,U.U)(c)," % "]})]}),(0,i.jsx)("div",{className:(0,N.d)("p-2 bg-neutral-000 absolute rounded border bottom-1 left-1"),onClick:m,children:(0,i.jsx)(d.J,{icon:"cancel",size:24})})]})}var R=n(98634);function A(e){var t=e.acceptableFileFormats,n=e.onUploadSuccess,r=e.error,s=e.className,u=e.shouldShrink,m=void 0!==u&&u,p=(0,o.Z)((0,l.useState)({}),2),f=p[0],v=p[1],j=function(){var e=(0,o.Z)(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],1),t=e[0];if(t){var n=(0,R.EL)();v(function(e){return(0,C.Z)((0,c.Z)({},e),(0,a.Z)({},n,t))})}},g=function(e){return function(t){n(t),v(function(t){t[e];var n=(0,S.Z)(t,[e].map(M.Z));return(0,c.Z)({},n)})}},_=function(e){return function(){v(function(t){t[e];var n=(0,S.Z)(t,[e].map(M.Z));return(0,c.Z)({},n)})}},y=(0,i.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,i.jsx)(d.J,{icon:"cube-file-image-add",color:"black",size:20}),(0,i.jsx)("p",{className:"text-body2-strong mt-1",children:m||!(0,b.x)(f)?"افزودن":"افزودن عکس یا ویدیو"})]});return(0,h.d)(x.X.ADD_COMMENT_FORM_MULTIPLE_STEP)||(0,h.d)(x.X.ADD_COMMENT_FORM_SINGLE_STEP)?(0,i.jsxs)("div",{className:(0,N.d)(s,{"w-full":!m,"flex gap-x-2":!(0,b.x)(Object.entries(f))}),children:[(0,i.jsx)(Z.t,{accept:t,updateFiles:j,dropZoneBody:y,dropZoneClassName:(0,N.d)("!border-none bg-neutral-100 !p-4 h-18",{"w-18":m||!(0,b.x)(Object.entries(f))}),hideButton:!0,errorClassName:"absolute whitespace-nowrap",error:r}),Object.entries(f).map(function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];return(0,i.jsx)(k,{className:"shrink-0 !h-18 !w-18",file:r,onSuccess:g(n),onFailed:_(n)},n)})]}):(0,i.jsxs)("div",{className:"flex",children:[(0,i.jsx)("div",{className:"relative pb-10",children:(0,i.jsx)(Z.t,{title:"افزودن",subTitle:(0,i.jsx)(d.J,{icon:"addCircleOutline",color:"secondary",size:32}),accept:t,updateFiles:j,className:"flex flex-col items-center text-secondary-500 py-4 px-5 rounded-medium cursor-pointer shrink-0 h-[96px] w-[96px]",hideButton:!0,errorClassName:"absolute whitespace-nowrap",error:r})}),Object.entries(f).map(function(e){var t=(0,o.Z)(e,2),n=t[0],r=t[1];return(0,i.jsx)(k,{className:"shrink-0",file:r,onSuccess:g(n),onFailed:_(n)},n)})]})}var z=(0,p.q)({type:m.XN.POST,url:function(e){var t=e.temporaryId;return"comments/".concat(t,"/media/delete/")}}),D=n(24556),P=n.n(D);function F(e){var t,n,r=e.value,o=void 0===r?[]:r,m=e.onChange,p=e.onChangeValue,j=e.shouldShakeHint,g=e.className,_=e.acceptableFileFormats,y=void 0===_?"image/jpeg, image/png, video/mp4 ,video/x-m4v ,video/x-msvideo":_,T=e.error,C=(0,v.E)({apiMethod:f}).request,S=(0,l.useRef)([]),M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};p((0,s.Z)(o||[]).concat([(0,c.Z)({},e)])),m((0,s.Z)(o||[]).concat([(0,c.Z)({},e)])),S.current=(0,s.Z)(o||[]).concat([e])};(0,l.useEffect)(function(){return function(){(0,b.x)(S.current)||C({mediaIds:S.current.map(function(e){return null==e?void 0:e.mediaTemporaryId}).filter(function(e){return!(0,b.x)(e)})})}},[]);var Z=(0,l.useRef)(null),w=!1,E=(0,v.E)({apiMethod:z}).request,O=(0,l.useCallback)(function(e,t){return function(){var n=null==t?void 0:t.filter(function(t,n){return e!==n}),r=t[e];(null==r?void 0:r.mediaTemporaryId)&&E({temporaryId:null==r?void 0:r.mediaTemporaryId}),m(n),p(n)}},[m,p,E]),U=(0,l.useMemo)(function(){return[(0,i.jsx)(A,{acceptableFileFormats:y,onUploadSuccess:M,error:T},"mediaUpload")].concat((0,s.Z)((o||[]).map(function(e,t,n){return(0,i.jsx)(I,{onDelete:O(t,n),mediaUrl:null==e?void 0:e.mediaUrl,mediaThumbnailUrl:null==e?void 0:e.mediaThumbnailUrl,mediaFileType:null==e?void 0:e.mediaType},null==e?void 0:e.mediaUrl)})))},(0,s.Z)(o||[]).concat([T]));return(0,h.d)(x.X.ADD_COMMENT_FORM_SINGLE_STEP)||(0,h.d)(x.X.ADD_COMMENT_FORM_MULTIPLE_STEP)?(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsxs)("div",{className:(0,N.d)("flex overflow-x-scroll w-full gap-x-2 overflow-y-hidden",g,P().mediaContainer),ref:Z,onMouseDown:function(e){w=!0,t=e.pageX-Z.current.offsetLeft,n=Z.current.scrollLeft},onMouseLeave:function(e){w=!1},onMouseUp:function(e){w=!1},onMouseMove:function(e){if(w){e.preventDefault(),e.stopPropagation();var r=e.pageX-Z.current.offsetLeft;Z.current.scrollLeft=n-(r-t)*3}},children:[(0,i.jsx)(A,{acceptableFileFormats:y,onUploadSuccess:M,error:T,shouldShrink:!(0,b.x)(o)},"mediaUpload"),!(0,b.x)(o)&&o.map(function(e,t,n){return(0,i.jsx)(I,{onDelete:O(t,n),mediaUrl:null==e?void 0:e.mediaUrl,mediaThumbnailUrl:null==e?void 0:e.mediaThumbnailUrl,mediaFileType:null==e?void 0:e.mediaType},null==e?void 0:e.mediaUrl)})]}),(0,i.jsxs)("div",{className:(0,N.d)("mt-2 flex items-center",(0,a.Z)({},P().shakeHint,!!j)),children:[(0,i.jsx)(d.J,{icon:"cube-alert-info-outline",size:16,color:"low-emphasis"}),(0,i.jsx)("span",{className:"text-caption mr-1 text-neutral-400",children:"بسیاری از کاربران در تصمیم‌گیری خود به تصاویر کالای شما نیاز دارند"})]})]}):(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("p",{className:"text-h5 text-neutral-900 lg:mt-5 mt-6",children:"ارسال محتوا"}),(0,i.jsx)("p",{className:"text-body-2 text-neutral-500 mb-4",children:"حداکثر ۵ عکس ۵ مگابایت و ۳ ویدیو با فرمت MP4 تا ۱۰۰ مگابایت"}),(0,i.jsx)("div",{className:(0,N.d)("flex items-center",g),children:(0,i.jsx)(u.l,{className:"min-w-0 grow mr-2",items:U})})]})}var L=n(59437),B=n(57931),V=n(16137),J=n(72610),q=n(65886),H=n(12694),X=n(76778),G=(0,p.q)({type:m.XN.POST,url:function(e){var t=e.productId;return"rate-review/products/".concat(t,"/submit/")},inputTransformer:function(e){var t=e.title,n=e.comment,r=e.advantages,a=e.disAdvantages,o=e.temporaryMediaIds,s=e.oldFilesMediaIds,i=e.isAnonymous,l=e.rating,c=e.recommend,d=e.trueToSize,u=e.orderItemId;return(0,H.s)({order_item_id:u,rating:(0,X._G)(l),title:t,comment:n,advantages:r,disadvantages:a,recommend:c,temporary_media_ids:o,old_file_ids:s,is_anonymous:i,true_to_size_rate:d})}}),Y={RATING:"rating",TRUE_TO_SIZE:"trueToSize",RECOMMEND:"recommend",TITLE:"title",ADVANTAGES:"advantages",DISADVANTAGES:"disadvantages",COMMENT:"comment",TEMPORARY_MEDIA_IDS:"temporaryMediaIds",IS_ANONYMOUS:"isAnonymous"},Q=n(46514),W=[{title:Q.Z.tooSmall,value:1},{title:Q.Z.small,value:2},{title:Q.Z.fit,value:3},{title:Q.Z.big,value:4},{title:Q.Z.tooBig,value:5}];function K(e){var t=e.option,n=e.className,r=e.isActive,a=e.isFirstOption,o=e.isLastOption,s=e.handleOnClick,l=t.title;return t.value,(0,i.jsx)("div",{className:(0,N.d)(n,"py-4 px-2 text-body-2-compact text-neutral-500 text-wrap border-complete text-center flex items-center flex-1",{"text-body2-strong-compact text-white bg-[#212121] z-1":r,"rounded-r-md":a,"rounded-l-md":o}),onClick:s,children:l})}function $(e){var t=e.className,n=e.options,r=e.value,a=e.onChange,o=e.onValueChange,s=function(e){o(e),a(e)};return(0,i.jsxs)("div",{className:t,children:[(0,i.jsx)("p",{className:"text-subtitle-strong mb-2",children:"کالای دریافتی کاملا اندازه شما بود؟"}),(0,i.jsx)("div",{className:"flex w-full",children:n.map(function(e,t){var a=e.title,o=e.value;return(0,i.jsx)(K,{option:e,className:"cursor-pointer",isActive:r===o,isFirstOption:0===t,isLastOption:t===n.length-1,handleOnClick:function(){return s(o)}},a)})})]})}var ee=n(72162),et=n(29502),en=n(2334);function er(e){var t=e.className,n=e.product,r=e.variantInfo,a=e.date,o=e.shouldHideVariant,s=e.isClickDisabled,l=void 0!==s&&s,c=n||{},d=c.productUrl,u=c.productImage,m=c.productTitle,p=r||{},f=p.commentVariantInfoSeller,x=p.commentVariantInfoColor,v=p.commentVariantInfoSize;return(0,i.jsx)("div",{className:(0,N.d)(t,"flex flex-col items-start"),children:(0,i.jsxs)("div",{className:"flex items-start",children:[(0,i.jsx)(L.e,{href:!l&&d,className:"flex flex-col items-start mb-4",children:(0,i.jsx)(j.E,{className:"shrink-0",image:u,alt:m,height:56,width:56})}),(0,i.jsxs)("div",{className:"mr-3",children:[(0,i.jsx)(L.e,{href:!l&&d,children:(0,i.jsx)("p",{className:"text-body1-strong text-neutral-800 ellipsis-1 grow-0",children:m})}),!(void 0!==o&&o)&&(0,i.jsxs)("div",{className:"flex items-center gap-1 text-caption whitespace-nowrap mt-2",children:[(0,i.jsx)(et.e,{seller:f}),(0,i.jsx)(ee.b,{color:x}),(0,i.jsx)(en.N,{size:v}),(0,i.jsx)("p",{className:"text-neutral-500",children:(0,U.U)(a)})]})]})]})})}var ea=n(8044),eo=n(59731);function es(e){var t=e.className,n=e.value,r=e.onChange,a=e.orderItemId,o=(0,v.E)({apiMethod:ea.y}).request;return(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"text-subtitle-strong",children:[(0,i.jsxs)("span",{children:[" ",n?"امتیاز ثبت شده:":"امتیاز دهید!"]}),(0,i.jsx)("span",{className:"text-primary-500",children:"*"})]}),(0,i.jsx)(eo.a,{shouldShowRateNumber:!0,className:(0,N.d)(t,"gap-x-6"),rate:n,onSetRate:function(e,t){o({rate:e,orderItemId:a,problemReasonId:t}).then(function(){null==r||r(e)})}})]})}var ei=n(15644),el=n(21494);function ec(e){var t=e.items;e.className;var n=(0,o.Z)((0,l.useState)(0),2),r=n[0],a=n[1];return((0,l.useEffect)(function(){if(t.length>1){var e=setInterval(function(){a(function(e){return(e+1)%t.length})},3e3);return function(){clearInterval(e)}}},[t.length]),(0,l.useEffect)(function(){if(r===t.length-1&&t.length>1){var e=setTimeout(function(){a(0)},3e3);return function(){clearTimeout(e)}}},[r,t.length]),(0,b.x)(t))?null:(0,i.jsx)("div",{className:"overflow-hidden mb-3 h-5 lg:mt-0",children:(0,i.jsx)("div",{style:{transform:"translateY(".concat(-20*r,"px)"),transitionDuration:"".concat(0===r?"0s":"".concat(300,"ms"))},children:t.map(function(e,t){return(0,i.jsx)("div",{children:e})})})})}var ed=n(24960),eu=n.n(ed),em=(0,l.forwardRef)(function(e,t){var n=e.className,r=e.openSelectCommentType,a=e.username,s=e.isAnonymous,c=e.suggestedQuestions,u=e.name,m=e.error,p=e.value,f=e.onChange,x=e.onTextChange,v=(0,o.Z)((0,l.useState)(!1),2),h=v[0],j=v[1],g=(0,o.Z)((0,l.useState)(!1),2),_=g[0],y=g[1],T=(0,l.useMemo)(function(){var e=null==c?void 0:c.map(function(e,t){return(0,i.jsx)("div",{className:"text-body-2 h-5",children:e})});return(null==e?void 0:e.length)>1&&(null==e||e.push((0,i.jsx)("div",{className:"text-body-2 h-5",children:c[0]}))),e},[c]),I=function(e){(null==e?void 0:e.length)>=3?(j(!0),y(!1),(null==e?void 0:e.length)>120&&y(!0)):j(!1)};(0,l.useEffect)(function(){I(p)},[]);var C={name:s?"کاربر دیجی‌کالا":a,buttonTp:s?"ارسال ناشناس":"ارسال با نام شما"};return(0,i.jsxs)("div",{className:(0,N.d)(n),children:[(0,i.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,i.jsx)("span",{className:(0,N.d)("text-subtitle-strong",eu().required_badge),children:"متن دیدگاه:"}),h&&(0,i.jsx)(ei.A,{activeColor:"success",isActive:!0,size:"small",radiusSize:"medium",className:(0,N.d)({"bg-app-background-mid-dark text-neutral-650":_},"text-caption-strong !border-none"),children:_?"ممنون که دیدگاه مفیدی برای کاربران می‌نویسی":"پیشنهاد می‌کنیم دیدگاهت رو کامل‌تر کنی"})]}),(0,i.jsx)(el.I,{ref:t,isTextarea:!0,fullWidth:!0,backgroundColor:"color-app-background",inputWrapperClassName:"!rounded-none !rounded-t-md !border-b-neutral-200 !border-l-neutral-300 !border-t-neutral-300 !border-r-neutral-300",inputClassName:"caret-black h-29",placeholder:"نظر خود را در مورد این کالا با کاربران دیگر به اشتراک بگذارید..",name:u,error:m,value:p,onChange:function(e){var t=e.target.value;I(t),x(t),f(e)}}),(0,i.jsxs)("div",{className:"border-complete !border-t-0 !border-l-neutral-300 !border-b-neutral-300 !border-r-neutral-300 p-2 items-center rounded-b-md flex justify-between mb-2",children:[(0,i.jsx)("span",{className:"text-body2-strong text-neutral-650 truncate",children:C.name}),(0,i.jsxs)("div",{className:"flex items-center bg-app-background-mid-dark text-neutral-650 px-3 py-1 rounded-lg cursor-pointer",onClick:r,children:[(0,i.jsx)("span",{className:"text-body-2 ml-1 whitespace-nowrap",children:C.buttonTp}),(0,i.jsx)(d.J,{icon:"cube-nav-chevron-down",size:18})]})]}),!(0,b.x)(c)&&(0,i.jsxs)("div",{className:"flex overflow-hidden h-5 items-center",children:[(0,i.jsx)(d.J,{icon:"cube-action-ai-all",color:"ai",className:"ml-1",size:20}),(0,i.jsx)("div",{className:"overflow-hidden h-5 flex",children:T.length>1?(0,i.jsx)(ec,{items:T}):T[0]})]})]})}),ep=n(50603),ef=n(58809);function ex(e){var t=e.isModalOpen,n=e.closeModal,r=e.isAnonymous,a=e.username,o=e.onChange,s=(0,l.useMemo)(function(){return[{name:"isAnonymous",label:"ارسال ناشناس",caption:(0,i.jsx)("div",{className:"text-caption text-neutral-600",children:"دیدگاه شما در صفحه محصول با عنوان کاربر دیجی‌کالا نمایش داده می‌شود"}),checked:r,value:"anonymous"},{name:"personal_name",label:"ارسال با نام شما",caption:(0,i.jsxs)("div",{className:"text-caption text-neutral-600",children:["دیدگاه شما در صفحه محصول با نام"," ",(0,i.jsx)("span",{className:"text-caption-strong",children:a})," نمایش داده می‌شود"]}),checked:!r,value:"known"}]},[r]);return(0,i.jsx)(ep.Modal,{isOpen:t,headerTitle:"نحوه نمایش دیدگاه‌ها",onDismiss:n,children:s.map(function(e){return(0,i.jsx)("div",{children:(0,i.jsx)(ef.Y,{name:e.name,label:e.label,checked:e.checked,description:e.caption,labelClassName:"text-body1-strong text-neutral-900",value:e.value,onChange:o})})})})}var ev=n(26442),eh=n(57874),eb=n(90247),eN=n(80803),ej=n(87049),eg=n(6013),e_=n(75490),ey=n(52536),eT={1:eh.U.tooSmall,2:eh.U.small,3:eh.U.fit,4:eh.U.big,5:eh.U.tooBig},eI=(r={},(0,a.Z)(r,eh.U.tooSmall,1),(0,a.Z)(r,eh.U.small,2),(0,a.Z)(r,eh.U.fit,3),(0,a.Z)(r,eh.U.big,4),(0,a.Z)(r,eh.U.tooBig,5),r);function eC(e){var t=e.productId,n=e.pending,r=e.addCommentData,a=e.hasThankYouStep,c=void 0!==a&&a,d=e.showThankYouStep,u=e.className,m=e.buttonClassName,p=e.onCommentChanged,f=e.onSuccess,x=e.onSetRate,h=e.rate,b=(0,eN.d)(),j=b.isOpen,g=b.onOpen,y=b.onClose,T=(0,v.E)({apiMethod:G,onSuccess:function(e,t){c?t.comment!==(null==D?void 0:D.commentBody)?null==d||d():((0,e_.p)({message:"نظر شما ثبت گردید"}),null==p||p()):(0,e_.p)({message:"نظر شما ثبت گردید و پس از تایید، نمایش داده خواهد شد"}),null==f||f(e)}}).request,I=(0,ej.v)(null===eg.p||void 0===eg.p?void 0:eg.p.userInfo),C=(0,eb.c)().ref,S=(0,l.useRef)(),M=(0,l.useRef)(),Z=(0,o.Z)((0,l.useState)(null),2),w=Z[0],E=Z[1],O=function(){var e;M.current.style.paddingBottom="".concat(null===(e=S.current)||void 0===e?void 0:e.clientHeight,"px")},U=r||{},k=U.product,R=U.hasTrueToSize,A=U.variantInfo,z=U.createdAt,D=U.comment,P=U.userIsbuyer,H=U.suggestedQuestions,X=U.orderItemId,Q=D||{},K=Q.commentBody,ee=Q.commentIsAnonymous,et=Q.commentFiles,en=Q.commentRate,ea=Q.commentTrueToSizeRate,eo=(0,o.Z)((0,l.useState)(K),2),ei=eo[0],el=eo[1],ec=(0,o.Z)((0,l.useState)(ea),2),ed=ec[0],eu=ec[1],ep=(0,o.Z)((0,l.useState)(et),2),ef=ep[0],eh=ep[1],eC=(0,o.Z)((0,l.useState)(ee),2),eS=eC[0],eM=eC[1],eZ=(0,l.useMemo)(function(){return JSON.stringify(et)},[et]),ew=(0,l.useMemo)(function(){return JSON.stringify(ef)},[ef]),eE=function(e){el(e)},eO=function(e){eu(e)},eU=function(e){eh(e)};(0,l.useEffect)(function(){eh(et)},[et]),(0,l.useEffect)(function(){eu(ea)},[ea]),(0,l.useEffect)(function(){el(K)},[K]),(0,l.useEffect)(function(){eM(ee)},[ee]),(0,l.useEffect)(function(){setTimeout(function(){null==w||w.focus()},800)},[w]);var ek=(null==ei?void 0:ei.length)>=5,eR=!(ei!==K||eS!==ee||ew!==eZ||ed!==ea),eA=(0,o.Z)((0,l.useState)(!1),2),ez=eA[0],eD=eA[1],eP=(0,l.useCallback)(function(){eD(!0),setTimeout(function(){eD(!1)},500)},[eD]);(0,l.useEffect)(function(){return null==w||w.addEventListener("blur",eP),function(){return null==w?void 0:w.removeEventListener("blur",eP)}},[w]);var eF=(0,o.Z)((0,l.useState)(h||en),2),eL=eF[0],eB=eF[1];(0,l.useEffect)(function(){h&&eB(h||en)},[h]);var eV=(0,l.useMemo)(function(){return[{component:(0,i.jsx)("div",{className:"border-complete-b"})},{component:(0,i.jsx)($,{options:W,onValueChange:eO,className:"mb-8 mt-5"}),name:Y.TRUE_TO_SIZE,disabled:!P||!R},{component:(0,i.jsx)(em,{className:"my-5",openSelectCommentType:g,username:null==I?void 0:I.userName,isAnonymous:eS,suggestedQuestions:H,onTextChange:eE,ref:function(e){E(e)}}),name:Y.COMMENT},{component:(0,i.jsx)(F,{onChangeValue:eU,shouldShakeHint:ez}),name:Y.TEMPORARY_MEDIA_IDS,rules:{validate:ey.zK},disabled:!P},{component:(0,i.jsx)(q.x,{handleHeight:!0,onResize:O,children:(0,i.jsxs)("div",{className:(0,N.d)("w-full z-1 bg-neutral-000 px-5 py-4 bottom-0 shadow-1-top",m),ref:S,children:[(0,i.jsx)(B.z,{size:"large",className:"w-full mb-2",type:"submit",disabled:!ek||eR,children:P?"ثبت امتیاز و دیدگاه":"ثبت دیدگاه"}),(0,i.jsxs)("p",{className:"text-caption text-center",children:["ثبت دیدگاه به معنی موافقت با",(0,i.jsx)(L.e,{className:"mx-1 text-secondary-500",href:ev.m,target:"_blank",children:"قوانین انتشار دیجی‌کالا"}),"است."]})]})})}].reduce(function(e,t){return t.disabled?e:(0,s.Z)(e).concat([t])},[])},[eS,ee,K,et,R,ez,eR,ek]);return void 0!==n&&n?(0,i.jsx)(J.g,{className:"my-20"}):(0,i.jsxs)("div",{className:u,children:[(0,i.jsxs)("div",{className:"p-4",ref:M,children:[(0,i.jsx)(er,{product:k,variantInfo:A,date:z,shouldHideVariant:!P,isClickDisabled:!0}),P&&(0,i.jsx)(es,{onChange:function(e){null==x||x(e),eB(e)},value:eL,orderItemId:X,className:"mt-4 mb-5"}),(0,i.jsx)(V.l,{ref:C,useFormProps:{mode:"onChange",defaultValues:{comment:K,temporaryMediaIds:et,trueToSize:eI[ea]}},items:eV,onSubmit:function(e){var n,r;return T({orderItemId:X||null,comment:e.comment,temporaryMediaIds:null===(n=e.temporaryMediaIds)||void 0===n?void 0:n.map(function(e){return null==e?void 0:e.mediaTemporaryId}).filter(Boolean),oldFilesMediaIds:null===(r=e.temporaryMediaIds)||void 0===r?void 0:r.map(function(e){var t;return(null==e?void 0:e.mediaTemporaryId)?void 0:null==e?void 0:null===(t=e.mediaStorageIds)||void 0===t?void 0:t[0]}).filter(Boolean),isAnonymous:eS,rating:eL,trueToSize:R&&P?eT[+e.trueToSize]:void 0,productId:t})}})]}),(0,i.jsx)(ex,{isModalOpen:j,closeModal:y,onChange:function(e){eM((0,_.t)(e.target.value,"anonymous"))},username:null==I?void 0:I.userName,isAnonymous:eS})]})}},21556:function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var r=n(2213),a=n(28141),o=n(8398),s=n(73587),i=(0,n(1324).q)({url:function(e){var t=e.productId,n=e.orderItemId,r=e.isEdit?1:0,a=n?"?orderItemId=".concat(n,"&edit=").concat(r):"?edit=".concat(r);return"rate-review/products/".concat(t,"/check/").concat(a)},transformer:function(e){var t=e.data||{},n=t.review,o=t.is_buyer,i=t.has_true_to_size,l=t.variant_info,c=t.product,d=t.order_item_id,u=t.created_at,m=t.suggested_questions;return{comment:(0,r.T)({data:n}),userIsbuyer:!!o,hasTrueToSize:i,product:(0,s.r)({data:c}),orderItemId:d,createdAt:u,variantInfo:(0,a.t)({data:l}),suggestedQuestions:m}},inputTransformer:o.d,disableGlobalSearchParams:!0})},52358:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var r=n(52322),a=n(58809),o=n(72677);function s(e){var t=e.transactionProblemReasons,n=e.onChange,s=e.value,i=e.name,l=e.className,c=t||{},d=c.transactionProblemReasonId,u=c.transactionProblemReasonLabel;return(0,r.jsxs)("label",{className:(0,o.d)("flex items-center mt-1 p-2",l),children:[(0,r.jsx)(a.Y,{checked:s==d,onChange:function(){return n({target:{value:d,name:i}})}}),(0,r.jsx)("p",{className:"text-body-1 text-neutral-700 mr-4",children:u})]})}function i(e){var t=e.itemClassName,n=e.transactionProblemReasons,a=e.onChange,o=e.value,i=e.name,l=e.hideTitle;return(0,r.jsxs)(r.Fragment,{children:[!l&&(0,r.jsx)("p",{className:"text-neutral-700 text-body-1 mb-1",children:"لطفا دلیل نارضایتی خود رامشخص کنید:"}),null==n?void 0:n.map(function(e){return(0,r.jsx)(s,{transactionProblemReasons:e,onChange:a,value:o,name:i,className:t},e.transactionProblemReasonId)})]})}},59731:function(e,t,n){"use strict";n.d(t,{a:function(){return b}});var r=n(66383),a=n(52322),o=n(2784),s=n(17156),i=n(98780),l=n(72610),c=n(50603),d=n(52358),u=(0,n(1324).q)({url:"/rate-review/problem-reasons/",transformer:function(e){var t=(e.data||{}).problem_reasons;return{problemReasons:Object.keys(t||{}).map(function(e){var n,r;return{transactionProblemReason:null===(n=t[e])||void 0===n?void 0:n.problem,transactionProblemReasonId:e,transactionProblemReasonLabel:null===(r=t[e])||void 0===r?void 0:r.title}})}}}),m=n(72873);function p(e){var t=e.isOpen,n=e.onClose,r=e.onChange,o=e.value,s=(0,m.V)({apiMethod:u,disabled:!t}),i=s.data,p=s.pending,f=(i||{}).problemReasons;return(0,a.jsx)(c.Modal,{isOpen:t,onDismiss:n,headerTitle:"چرا راضی نبودید؟",headerDescription:"لطفاً دلیل نارضایتی خود را انتخاب کنید تا خدمات بهتری ارائه دهیم.",children:p||!t?(0,a.jsx)(l.g,{className:"my-20"}):(0,a.jsx)(d.d,{itemClassName:"!p-0",transactionProblemReasons:f,onChange:r,value:o,hideTitle:!0})})}var f=n(35239),x=n(80803),v=n(52216),h=n(72677);function b(e){var t=e.className,n=e.rate,l=e.onSetRate,c=e.shouldShowRateNumber,d=e.classNameRateNumber,u=void 0===d?"text-body1-strong mt-2 text-neutral-700":d,m=e.size,b=void 0===m?24:m,N=e.disableProblemReason,j=(0,s.cC)(f.U.LOW_RATE_REASON),g=(0,x.d)(),_=g.isOpen,y=g.onOpen,T=g.onClose,I=(0,r.Z)((0,o.useState)(void 0),2),C=I[0],S=I[1],M=(0,o.useRef)();return(0,a.jsxs)("div",{className:(0,h.d)(t,"flex"),children:[(0,a.jsx)(p,{isOpen:_,onClose:T,onChange:function(e){var t=Number(e.target.value);S(t),setTimeout(function(){l(M.current,t),T()},200)},value:C}),Array.from({length:5},function(e,t){var r=n>t,o=t+1;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex flex-col items-center",children:[(0,a.jsx)(i.J,{onClick:function(){if(N||!j){l(o,null);return}n>2&&o<=2||!n&&o<=2?(S(void 0),y(),M.current=o):l(o,null)},icon:r?"starFill":"starOutline",color:r?"warning":"low-emphasis",size:b}),c&&(0,a.jsx)("p",{className:u,children:(0,v.U)(o)})]})})})]})}},72162:function(e,t,n){"use strict";n.d(t,{b:function(){return l}});var r=n(52322),a=n(98780),o=n(72677),s=n(10863),i=n.n(s);function l(e){var t=e.className,n=e.color||{},s=n.colorTitle,l=n.colorHexCode;return s?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:(0,o.d)(t,"ml-2 inline-block rounded-circle",i().OrderItemColor),style:{backgroundColor:l}}),(0,r.jsx)("p",{className:"text-neutral-500 inline",children:s}),(0,r.jsx)(a.J,{icon:"dot",color:"low-emphasis",size:16})]}):null}},29502:function(e,t,n){"use strict";n.d(t,{e:function(){return s}});var r=n(52322),a=n(98780),o=n(98723);function s(e){var t=e.seller||{},n=t.sellerTitle,s=t.sellerUrl;return n?(0,r.jsxs)(o.r,{className:"flex items-center",target:"_blank",to:s,children:[(0,r.jsx)(a.J,{icon:"seller",size:18,className:"text-neutral-700 ml-2"}),(0,r.jsx)("p",{className:"text-neutral-500",children:n}),(0,r.jsx)(a.J,{icon:"dot",color:"low-emphasis",size:16})]}):null}},2334:function(e,t,n){"use strict";n.d(t,{N:function(){return o}});var r=n(52322),a=n(98780);function o(e){var t=(e.size||{}).sizeTitle;return t?(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)(a.J,{icon:"variationSize",size:18}),(0,r.jsx)("p",{className:"text-neutral-500 inline mr-1",children:t}),(0,r.jsx)(a.J,{icon:"dot",color:"low-emphasis",size:16})]}):null}},28141:function(e,t,n){"use strict";n.d(t,{t:function(){return s}});var r=n(52126),a=n(82382),o=n(63431);function s(e){var t=e.data||{},n=t.seller,s=t.size,i=t.color;return{commentVariantInfoSeller:(0,a.N)({data:n}),commentVariantInfoColor:(0,r.n)({data:i}),commentVariantInfoSize:(0,o.E)({data:s})}}},45859:function(e){e.exports={AddCommentMediaItem__CTADeleteIcon:"styles_AddCommentMediaItem__CTADeleteIcon__Olpt8",AddCommentMediaItem__VideoPlayButton:"styles_AddCommentMediaItem__VideoPlayButton__wH5ZZ"}},24556:function(e){e.exports={mediaContainer:"styles_mediaContainer__zU75r",shakeHint:"styles_shakeHint__Vxleh",shakeHintAnimation:"styles_shakeHintAnimation__0NMjC"}},24960:function(e){e.exports={required_badge:"styles_required_badge__zrGFx"}},10863:function(e){e.exports={OrderItemColor:"styles_OrderItemColor__T8oc3"}},32534:function(e){e.exports={UploadBox__dropZone:"styles_UploadBox__dropZone__jrLQi","UploadBox__dropZone--active-drag":"styles_UploadBox__dropZone--active-drag__fNEJa","UploadBox__dropZone--error":"styles_UploadBox__dropZone--error___tMNb"}}}]);